1. Установить Apache веб-сервер на VM и настроить его на работу с PHP (например, как указано в инструкции). Поменять порт по умолчанию на 8080. Убедиться, что Apache работает и возвращает страницу с информацией о PHP.

Устанавливаю Apache и PHP
```
root@ales:/home/ales# apt install apache2
root@ales:/home/ales# apt install php libapache2-mod-php
```

Добавляю файл с скриптом root@ales:/var/www/html# nano phpinfo.
```php
<?php
phpinfo();
?>
```

В файлах /etc/apache2/ports.conf и /etc/apache2/sites-available/000-default.conf меняю 80 порт на 8080

2. Установить Nginx на VM.

```
root@ales:/var/www/html# apt install nginx
```

3. Скопировать папку https://github.com/tms-dos21-onl/_sandbox/tree/main/lecture15/react_nginx/build на VM и настроить Nginx на хостинг этого веб-приложения. Проверить работоспособность приложения путем посещения всех доступных ссылок на главной странице и обновления каждой из страниц в веб-браузере.

4. Скопировать папку https://github.com/tms-dos21-onl/_sandbox/tree/main/lecture15/api на VM и запустить Python REST Api приложение согласно инструкции. Проверить работоспособность всех доступных REST Api методов с помощью интерфейса Swagger.

Устанавливаю необходимые пакеты 
```
root@ales:/home/ales/_sandbox/lecture15# cp -r api /var/www/html
root@ales:/home/ales/_sandbox/lecture15# apt install python3 python3-pip python3.11-venv
```

Запускаю вируатльное окружение и устанавливаю зависимости
```
root@ales://# python3 -m venv api-env
root@ales://# source api-env/bin/activate
(api-env) root@ales:/var/www/html/api# pip install -r /var/www/html/api/requirements.tx
```

Запускаю приложение
```
(api-env) root@ales:/home/ales# python3 /var/www/html/api/main.py
 * Serving Flask app 'main'
 * Debug mode: on
```

Результат запросов
```
127.0.0.1 - - [19/Jun/2024 11:54:37] "GET /apidocs/ HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:37] "GET /flasgger_static/swagger-ui-bundle.js HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:37] "GET /flasgger_static/swagger-ui.css HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:37] "GET /flasgger_static/swagger-ui-standalone-preset.js HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:37] "GET /flasgger_static/lib/jquery.min.js HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:38] "GET /apispec_1.json HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:42] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:54:57] "GET /ping HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:55:01] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:55:04] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:55:08] "POST /uploadFile HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 11:55:12] "POST /uploadFile HTTP/1.1" 200 -
```
5. Настроить Nginx как Reverse Proxy для Python REST Api приложения из предыдущего пункта. А затем:
- Открыть Swagger для веб-приложения через Nginx (http://<NGINX_IP>:<NGINX_PORT>/apidocs).
- Проверить работоспособность всех доступных REST Api методов через Nginx с помощью интерфейса Swagger. Убедиться, что нет ошибок ни в логах Rest Api приложения, ни в HTTP ответе в Swagger. При необходимости поправить конфигурацию Nginx сервера, чтобы все методы работали.
- Для тестирования метода /uploadFile использовать файл размером больше 1MB.
- Вывести в консоль содержимое файла конфигурации Nginx с измененными значениями и комментариями.

Все работает
```
127.0.0.1 - - [19/Jun/2024 12:24:04] "GET /apispec_1.json HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:25:05] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:25:15] "GET /ping HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:25:18] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:25:47] "POST /uploadFile HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:26:19] "GET /delayedResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:26:23] "POST /readBigResponseSlowly HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:28:45] "GET /ping HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:28:49] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:29:16] "GET /bigResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:29:51] "GET /delayedResponse HTTP/1.1" 200 -
127.0.0.1 - - [19/Jun/2024 12:30:22] "POST /readBigResponseSlowly HTTP/1.1" 200 -
```
Конфигурация
```bash
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/html;
    index index.html index.htm index.nginx-debian.html;

    server_name _;

    location / {
        try_files $uri $uri/ =404;
    }

    # Проксирование запросов к API
    location /api/ {
        proxy_pass http://127.0.0.1:5000/;  # Проксмрование запросов к локальному API серверу
        proxy_set_header Host $host;
   }

    # Проксирование запросов к Swagger UI
    location /apidocs {
        proxy_pass http://127.0.0.1:5000/apidocs;  # Проксирование запросов к Swagger UI
        proxy_set_header Host $host;
    }
}

```
