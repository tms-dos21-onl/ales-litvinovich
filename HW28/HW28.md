1. Создать новый Jenkins агент и установить на нём Docker.

Создаю новую виртулку для нового агента

Создаю агента
images

Устанавливаю докер
```
root@vm3:/home/alesworld1# apt install -y docker.io
root@vm3:/home/alesworld1# systemctl enable docker
root@vm3:/home/alesworld1# systemctl start docker
```
2. Изменить Jenkinsfile из предыдущего домашнего задания путём добавления стадии "Integration Tests" между стадиями Build и Publish. Она должна запускаться в Docker контейнере на созданном ранее Jenkins агенте при помощи Docker Pipeline плагина и выполнять следующие шаги:
- Запуск приложения в фоновом режиме.
- Проверка работоспособности приложения при помощи curl.

Новый Jenkinsfile
```
pipeline {
    agent any

    environment {
        GIT_CREDENTIALS_ID = 'git-credentials'
    }

    stages {
        stage('Clone') {
            steps {
                git branch: 'main', credentialsId: env.GIT_CREDENTIALS_ID, url: 'https://my_key@github.com/tms-dos21-onl/spring-petclinic.git'
            }
        }
        stage('Build') {
            steps {
                script {
                    docker.build('spring-petclinic:latest')
                }
            }
        }
        stage('Integration Tests') {
            agent {
                docker {
                    image 'openjdk:17-jre-slim' 
                    label 'docker-agent'
                    args '-v /tmp:/tmp'
                }
            }
            steps {
                stash includes: '**/target/*.jar', name: 'app'
                script {
                   
                    sh 'java -jar target/spring-petclinic.jar &'
                    sleep(10) 
                    sh 'curl --fail --silent --show-error http://localhost:8080'
                }
            }
            post {
                always {
                    unstash 'app'
                }
            }
        }
        stage('Publish') {
            steps {
                archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true
                junit '**/target/surefire-reports/*.xml'
            }
        }
    }
}

```

Для передачи артефактов между агентами использовать stash/unstash.
